
> true-north@1.0.0 test
> jest llm.test.ts

  console.error
    LLM Analysis Failed: TypeError: client.chat.completions.create is not a function
        at create (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\lib\engine\llm.ts:53:52)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:3:17)
        at _next (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:17:9)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:22:7
        at new Promise (<anonymous>)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:14:12
        at apply (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\lib\engine\llm.ts:89:2)
        at apply (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\lib\engine\llm.ts:27:41)
        at Object.<anonymous> (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\__tests__\llm.test.ts:49:44)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:3:17)
        at _next (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:17:9)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:22:7
        at new Promise (<anonymous>)
        at Object.<anonymous> (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:14:12)
        at Promise.then.completed (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 77 |[39m     }[33m;[39m
     [90m 78 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 79 |[39m     console[33m.[39merror([32m"LLM Analysis Failed:"[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 80 |[39m     [36mreturn[39m {
     [90m 81 |[39m       category[33m:[39m [32m"Uncategorized"[39m[33m,[39m
     [90m 82 |[39m       cleanMerchantName[33m:[39m txn[33m.[39mdescription[33m,[39m[0m

      at error (lib/engine/llm.ts:79:13)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:14:12
      at apply (lib/engine/llm.ts:89:2)
      at apply (lib/engine/llm.ts:27:41)
      at Object.<anonymous> (__tests__/llm.test.ts:49:44)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime/helpers/asyncToGenerator.js:14:12)

  console.error
    LLM Analysis Failed: TypeError: client.chat.completions.create is not a function
        at create (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\lib\engine\llm.ts:53:52)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:3:17)
        at _next (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:17:9)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:22:7
        at new Promise (<anonymous>)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:14:12
        at apply (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\lib\engine\llm.ts:27:41)
        at Object.<anonymous> (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\__tests__\llm.test.ts:74:44)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:3:17)
        at _next (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:17:9)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:22:7
        at new Promise (<anonymous>)
        at Object.<anonymous> (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:14:12)
        at Promise.then.completed (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 77 |[39m     }[33m;[39m
     [90m 78 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 79 |[39m     console[33m.[39merror([32m"LLM Analysis Failed:"[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 80 |[39m     [36mreturn[39m {
     [90m 81 |[39m       category[33m:[39m [32m"Uncategorized"[39m[33m,[39m
     [90m 82 |[39m       cleanMerchantName[33m:[39m txn[33m.[39mdescription[33m,[39m[0m

      at error (lib/engine/llm.ts:79:13)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:14:12
      at apply (lib/engine/llm.ts:27:41)
      at Object.<anonymous> (__tests__/llm.test.ts:74:44)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime/helpers/asyncToGenerator.js:14:12)

  console.error
    LLM Analysis Failed: TypeError: client.chat.completions.create is not a function
        at create (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\lib\engine\llm.ts:53:52)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:3:17)
        at _next (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:17:9)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:22:7
        at new Promise (<anonymous>)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:14:12
        at apply (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\lib\engine\llm.ts:27:41)
        at Object.<anonymous> (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\__tests__\llm.test.ts:82:44)
        at Generator.next (<anonymous>)
        at asyncGeneratorStep (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:3:17)
        at _next (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:17:9)
        at C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:22:7
        at new Promise (<anonymous>)
        at Object.<anonymous> (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\@babel\runtime\helpers\asyncToGenerator.js:14:12)
        at Promise.then.completed (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:316:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\Billy\OneDrive\Desktop\CodeProjects\Mum_Finance\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 77 |[39m     }[33m;[39m
     [90m 78 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 79 |[39m     console[33m.[39merror([32m"LLM Analysis Failed:"[39m[33m,[39m error)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 80 |[39m     [36mreturn[39m {
     [90m 81 |[39m       category[33m:[39m [32m"Uncategorized"[39m[33m,[39m
     [90m 82 |[39m       cleanMerchantName[33m:[39m txn[33m.[39mdescription[33m,[39m[0m

      at error (lib/engine/llm.ts:79:13)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:22:7
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:14:12
      at apply (lib/engine/llm.ts:27:41)
      at Object.<anonymous> (__tests__/llm.test.ts:82:44)
      at asyncGeneratorStep (node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)
      at node_modules/@babel/runtime/helpers/asyncToGenerator.js:22:7
      at Object.<anonymous> (node_modules/@babel/runtime/helpers/asyncToGenerator.js:14:12)

node.exe : FAIL __t
ests__/llm.test.ts
At line:1 char:1
+ & "C:\Program Fil
es\nodejs/node.exe"
 "C:\Users\Billy\Ap
pData\Roaming\ ...
+ ~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~
    + CategoryInfo 
             : No  
  tSpecified: (F   
 AIL __tests__/    
llm.test.ts:St    
ring) [], Remo    
teException
    + FullyQualifi 
   edErrorId : Na  
  tiveCommandErr   
 or
 
  LLM Transaction 
Analysis
    ├ù correctly 
parses valid JSON 
response (46 ms)
    ΓêÜ handles 
invalid category 
gracefully (3 ms)
    ΓêÜ handles 
API failure 
gracefully (5 ms)

  ΓùÅ LLM 
Transaction 
Analysis ΓÇ║ 
correctly parses 
valid JSON response

    expect(received
).toBe(expected) 
// Object.is 
equality

    Expected: 
"Entertainment"
    Received: 
"Uncategorized"

    [0m [90m 49 
|[39m     
[36mconst[39m 
result [33m=[39m 
[36mawait[39m ana
lyzeTransaction(moc
kTxn)[33m;[39m
     [90m 50 
|[39m
    [31m[1m>[22m
[39m[90m 51 
|[39m     expect(r
esult[33m.[39mcat
egory)[33m.[39mto
Be([32m"Entertainm
ent"[39m)[33m;[3
9m
     [90m    
|[39m             
                [3
1m[1m^[22m[39m
     [90m 52 
|[39m     expect(r
esult[33m.[39mcle
anMerchantName)[33
m.[39mtoBe([32m"N
etflix"[39m)[33m;
[39m
     [90m 53 
|[39m     expect(r
esult[33m.[39misS
ubscription)[33m.
[39mtoBe([36mtrue
[39m)[33m;[39m
     [90m 54 
|[39m     expect(r
esult[33m.[39mcon
fidence)[33m.[39m
toBe([35m0.95[39m
)[33m;[39m[0m

      at 
Object.toBe (__test
s__/llm.test.ts:51:
29)
      at 
asyncGeneratorStep 
(node_modules/@babe
l/runtime/helpers/a
syncToGenerator.js:
3:17)
      at _next (nod
e_modules/@babel/ru
ntime/helpers/async
ToGenerator.js:17:9
)

-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |    1.11 |     0.42 |    0.51 |    1.22 |                   
 app               |       0 |        0 |       0 |       0 |                   
  _layout.tsx      |       0 |      100 |       0 |       0 | 7                 
  backup.tsx       |       0 |        0 |       0 |       0 | 18-223            
  import.tsx       |       0 |        0 |       0 |       0 | 19-107            
 app/(tabs)        |       0 |        0 |       0 |       0 |                   
  _layout.tsx      |       0 |        0 |       0 |       0 | 6-91              
  calendar.tsx     |       0 |        0 |       0 |       0 | 16-96             
  index.tsx        |       0 |        0 |       0 |       0 | 20-274            
  insights.tsx     |       0 |        0 |       0 |       0 | 11-57             
  payid.tsx        |       0 |        0 |       0 |       0 | 14-226            
  transactions.tsx |       0 |        0 |       0 |       0 | 27-379            
 lib/engine        |    6.45 |     3.07 |       4 |    7.61 |                   
  bayesian.ts      |       0 |        0 |       0 |       0 | 16-180            
  llm.ts           |   46.66 |    16.66 |     100 |      50 | 59-70             
  recurring.ts     |       0 |        0 |       0 |       0 | 22-90             
  rules.ts         |       5 |        0 |       0 |    6.66 | 16-81             
 lib/parsers       |       0 |        0 |       0 |       0 |                   
  index.ts         |       0 |        0 |       0 |       0 | 28-486            
 lib/store         |       0 |        0 |       0 |       0 |                   
  index.ts         |       0 |        0 |       0 |       0 | 68-235            
 lib/utils         |       0 |        0 |       0 |       0 |                   
  format.ts        |       0 |        0 |       0 |       0 | 8-43              
  roundUp.ts       |       0 |        0 |       0 |       0 | 23-48             
  safeBalance.ts   |       0 |        0 |       0 |       0 | 36-78             
  subscriptions.ts |       0 |        0 |       0 |       0 | 7-131             
  surcharges.ts    |       0 |        0 |       0 |       0 | 8-57              
-------------------|---------|----------|---------|---------|-------------------
Test Suites: 1 
failed, 1 total
Tests:       1 
failed, 2 passed, 
3 total
Snapshots:   0 
total
Time:        2.899 
s, estimated 5 s
Ran all test 
suites matching 
/llm.test.ts/i.
